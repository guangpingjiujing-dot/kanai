[0m15:33:14.998131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ee240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ee030>]}


============================== 15:33:15.008637 | 8a02402c-c5ba-4563-8195-3ceac71bc62c ==============================
[0m15:33:15.008637 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:33:15.009940 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/rimix/work/kanai/traning/jaffle_shop', 'version_check': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'empty': 'None', 'debug': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/rimix/work/kanai/traning/jaffle_shop/logs', 'printer_width': '80', 'static_parser': 'True', 'use_colors': 'True'}
[0m15:33:15.052430 [info ] [MainThread]: dbt version: 1.11.2
[0m15:33:15.053262 [info ] [MainThread]: python version: 3.12.0
[0m15:33:15.054152 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m15:33:15.055024 [info ] [MainThread]: os info: macOS-14.8.3-x86_64-i386-64bit
[0m15:33:15.081713 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'AZURE_TENANT_ID'
[0m15:33:15.086474 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.21818735, "process_in_blocks": "0", "process_kernel_time": 0.555031, "process_mem_max_rss": "98234368", "process_out_blocks": "0", "process_user_time": 2.413047}
[0m15:33:15.087625 [debug] [MainThread]: Command `dbt debug` failed at 15:33:15.087388 after 0.22 seconds
[0m15:33:15.088425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b66900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108218350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ee120>]}
[0m15:33:15.089898 [debug] [MainThread]: Flushing usage events
[0m15:33:16.424286 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:36.890270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113d7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127a6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127a5fa0>]}


============================== 15:33:36.902294 | a6a1d244-f9eb-4209-9a3c-22fd8657d614 ==============================
[0m15:33:36.902294 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:33:36.903459 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_colors': 'True', 'write_json': 'True', 'log_format': 'default', 'introspect': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'no_print': 'None', 'empty': 'None', 'version_check': 'True', 'debug': 'False', 'target_path': 'None', 'profiles_dir': '/Users/rimix/work/kanai/traning/jaffle_shop', 'partial_parse': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/rimix/work/kanai/traning/jaffle_shop/logs', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug'}
[0m15:33:36.930533 [info ] [MainThread]: dbt version: 1.11.2
[0m15:33:36.931395 [info ] [MainThread]: python version: 3.12.0
[0m15:33:36.932162 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m15:33:36.932969 [info ] [MainThread]: os info: macOS-14.8.3-x86_64-i386-64bit
[0m15:33:37.835268 [info ] [MainThread]: Using profiles dir at /Users/rimix/work/kanai/traning/jaffle_shop
[0m15:33:37.835995 [info ] [MainThread]: Using profiles.yml file at /Users/rimix/work/kanai/traning/jaffle_shop/profiles.yml
[0m15:33:37.836528 [info ] [MainThread]: Using dbt_project.yml file at /Users/rimix/work/kanai/traning/jaffle_shop/dbt_project.yml
[0m15:33:37.837051 [info ] [MainThread]: adapter type: fabric
[0m15:33:37.837554 [info ] [MainThread]: adapter version: 1.9.8
[0m15:33:38.029134 [info ] [MainThread]: Configuration:
[0m15:33:38.029874 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:33:38.031362 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:33:38.032120 [info ] [MainThread]: Required dependencies:
[0m15:33:38.033121 [debug] [MainThread]: Executing "git --help"
[0m15:33:38.081512 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:33:38.083875 [debug] [MainThread]: STDERR: "b''"
[0m15:33:38.084740 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:33:38.085460 [info ] [MainThread]: Connection:
[0m15:33:38.086167 [info ] [MainThread]:   server: t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com
[0m15:33:38.086757 [info ] [MainThread]:   database: jaffle_warehouse
[0m15:33:38.087342 [info ] [MainThread]:   schema: jaffle_training
[0m15:33:38.087921 [info ] [MainThread]:   warehouse_snapshot_name: None
[0m15:33:38.088484 [info ] [MainThread]:   snapshot_timestamp: None
[0m15:33:38.089079 [info ] [MainThread]:   UID: None
[0m15:33:38.089644 [info ] [MainThread]:   workspace_id: None
[0m15:33:38.090288 [info ] [MainThread]:   authentication: ActiveDirectoryServicePrincipal
[0m15:33:38.090906 [info ] [MainThread]:   retries: 3
[0m15:33:38.091473 [info ] [MainThread]:   login_timeout: 0
[0m15:33:38.092054 [info ] [MainThread]:   query_timeout: 0
[0m15:33:38.092611 [info ] [MainThread]:   trace_flag: False
[0m15:33:38.093154 [info ] [MainThread]:   encrypt: True
[0m15:33:38.093854 [info ] [MainThread]:   trust_cert: False
[0m15:33:38.094477 [info ] [MainThread]:   api_url: https://api.fabric.microsoft.com/v1
[0m15:33:38.095751 [info ] [MainThread]: Registered adapter: fabric=1.9.8
[0m15:33:38.367944 [debug] [MainThread]: Acquiring new fabric connection 'debug'
[0m15:33:38.369032 [debug] [MainThread]: Using fabric connection "debug"
[0m15:33:38.369621 [debug] [MainThread]: On debug: select 1 as id
[0m15:33:38.370166 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:38.370900 [debug] [MainThread]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m15:33:40.527022 [debug] [MainThread]: fabric adapter: Connected to db: jaffle_warehouse
[0m15:33:40.578662 [debug] [MainThread]: SQL status: OK in 2.000 seconds
[0m15:33:40.585984 [debug] [MainThread]: On debug: Close
[0m15:33:40.586989 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:33:40.587982 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:33:40.592062 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.8492658, "process_in_blocks": "0", "process_kernel_time": 0.593554, "process_mem_max_rss": "121614336", "process_out_blocks": "0", "process_user_time": 3.326585}
[0m15:33:40.593700 [debug] [MainThread]: Command `dbt debug` succeeded at 15:33:40.593474 after 3.85 seconds
[0m15:33:40.594417 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:33:40.595123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11273eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11273e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112af7950>]}
[0m15:33:40.596099 [debug] [MainThread]: Flushing usage events
[0m15:33:41.494739 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:34:05.848085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128b3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11353a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135a1f10>]}


============================== 15:34:05.855894 | 91a96e09-aab7-4f04-83fa-a0ac55b53634 ==============================
[0m15:34:05.855894 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:34:05.856980 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'version_check': 'True', 'quiet': 'False', 'debug': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/rimix/work/kanai/traning/jaffle_shop', 'log_format': 'default', 'invocation_command': 'dbt debug', 'empty': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_path': '/Users/rimix/work/kanai/traning/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'no_print': 'None'}
[0m15:34:05.882584 [info ] [MainThread]: dbt version: 1.11.2
[0m15:34:05.883927 [info ] [MainThread]: python version: 3.12.0
[0m15:34:05.885009 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m15:34:05.885986 [info ] [MainThread]: os info: macOS-14.8.3-x86_64-i386-64bit
[0m15:34:05.906527 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'AZURE_TENANT_ID'
[0m15:34:05.909666 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.17814219, "process_in_blocks": "0", "process_kernel_time": 0.284943, "process_mem_max_rss": "98533376", "process_out_blocks": "0", "process_user_time": 2.337039}
[0m15:34:05.910808 [debug] [MainThread]: Command `dbt debug` failed at 15:34:05.910568 after 0.18 seconds
[0m15:34:05.911960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11353a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135a39b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11364f590>]}
[0m15:34:05.913182 [debug] [MainThread]: Flushing usage events
[0m15:34:06.816597 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:36:06.678343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb00770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8fa330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8fa000>]}


============================== 15:36:06.685980 | d6f0deee-f4f3-46df-ba5d-f4a567ca1cff ==============================
[0m15:36:06.685980 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:36:06.687126 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'profiles_dir': '/Users/rimix/work/kanai/traning/jaffle_shop', 'log_path': '/Users/rimix/work/kanai/traning/jaffle_shop/logs', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_cache_events': 'False', 'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'target_path': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'no_print': 'None', 'empty': 'None', 'fail_fast': 'False'}
[0m15:36:06.710669 [info ] [MainThread]: dbt version: 1.11.2
[0m15:36:06.711417 [info ] [MainThread]: python version: 3.12.0
[0m15:36:06.712031 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m15:36:06.712634 [info ] [MainThread]: os info: macOS-14.8.3-x86_64-i386-64bit
[0m15:36:07.018442 [info ] [MainThread]: Using profiles dir at /Users/rimix/work/kanai/traning/jaffle_shop
[0m15:36:07.019150 [info ] [MainThread]: Using profiles.yml file at /Users/rimix/work/kanai/traning/jaffle_shop/profiles.yml
[0m15:36:07.019682 [info ] [MainThread]: Using dbt_project.yml file at /Users/rimix/work/kanai/traning/jaffle_shop/dbt_project.yml
[0m15:36:07.020264 [info ] [MainThread]: adapter type: fabric
[0m15:36:07.020764 [info ] [MainThread]: adapter version: 1.9.8
[0m15:36:07.201974 [info ] [MainThread]: Configuration:
[0m15:36:07.202784 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:36:07.203336 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:36:07.203844 [info ] [MainThread]: Required dependencies:
[0m15:36:07.204441 [debug] [MainThread]: Executing "git --help"
[0m15:36:07.256936 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:36:07.258393 [debug] [MainThread]: STDERR: "b''"
[0m15:36:07.259083 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:36:07.260448 [info ] [MainThread]: Connection:
[0m15:36:07.261349 [info ] [MainThread]:   server: t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com
[0m15:36:07.262001 [info ] [MainThread]:   database: jaffle_warehouse
[0m15:36:07.262612 [info ] [MainThread]:   schema: jaffle_training
[0m15:36:07.263207 [info ] [MainThread]:   warehouse_snapshot_name: None
[0m15:36:07.263803 [info ] [MainThread]:   snapshot_timestamp: None
[0m15:36:07.264812 [info ] [MainThread]:   UID: None
[0m15:36:07.269476 [info ] [MainThread]:   workspace_id: None
[0m15:36:07.270261 [info ] [MainThread]:   authentication: ActiveDirectoryServicePrincipal
[0m15:36:07.271002 [info ] [MainThread]:   retries: 3
[0m15:36:07.271834 [info ] [MainThread]:   login_timeout: 0
[0m15:36:07.272740 [info ] [MainThread]:   query_timeout: 0
[0m15:36:07.273605 [info ] [MainThread]:   trace_flag: False
[0m15:36:07.275002 [info ] [MainThread]:   encrypt: True
[0m15:36:07.276010 [info ] [MainThread]:   trust_cert: False
[0m15:36:07.286650 [info ] [MainThread]:   api_url: https://api.fabric.microsoft.com/v1
[0m15:36:07.288262 [info ] [MainThread]: Registered adapter: fabric=1.9.8
[0m15:36:07.475603 [debug] [MainThread]: Acquiring new fabric connection 'debug'
[0m15:36:07.476647 [debug] [MainThread]: Using fabric connection "debug"
[0m15:36:07.477230 [debug] [MainThread]: On debug: select 1 as id
[0m15:36:07.477713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:36:07.478279 [debug] [MainThread]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m15:36:09.195895 [debug] [MainThread]: fabric adapter: Connected to db: jaffle_warehouse
[0m15:36:09.242305 [debug] [MainThread]: SQL status: OK in 2.000 seconds
[0m15:36:09.246240 [debug] [MainThread]: On debug: Close
[0m15:36:09.247502 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:36:09.248916 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:36:09.252617 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.6868818, "process_in_blocks": "0", "process_kernel_time": 0.444065, "process_mem_max_rss": "122273792", "process_out_blocks": "0", "process_user_time": 2.964948}
[0m15:36:09.254190 [debug] [MainThread]: Command `dbt debug` succeeded at 15:36:09.253971 after 2.69 seconds
[0m15:36:09.255866 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:36:09.256875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d170fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca51280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2516d0>]}
[0m15:36:09.257662 [debug] [MainThread]: Flushing usage events
[0m15:36:10.425900 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:38:20.036614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed7c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f406420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4060f0>]}


============================== 15:38:20.045834 | 7a31a718-472c-459c-b187-c64147b8d7bf ==============================
[0m15:38:20.045834 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:38:20.046984 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'debug': 'False', 'invocation_command': 'dbt seed', 'log_path': '/Users/rimix/work/kanai/traning/jaffle_shop/logs', 'printer_width': '80', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'profiles_dir': '/Users/rimix/work/kanai/traning/jaffle_shop', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'log_format': 'default', 'no_print': 'None', 'fail_fast': 'False', 'static_parser': 'True'}
[0m15:38:20.649553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a31a718-472c-459c-b187-c64147b8d7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb88a40>]}
[0m15:38:20.752074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a31a718-472c-459c-b187-c64147b8d7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fad3ec0>]}
[0m15:38:20.753148 [info ] [MainThread]: Registered adapter: fabric=1.9.8
[0m15:38:21.028472 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:38:21.030283 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:38:21.031259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7a31a718-472c-459c-b187-c64147b8d7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb89e20>]}
[0m15:38:23.209592 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.mart
- models.jaffle_shop.staging
[0m15:38:23.221026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a31a718-472c-459c-b187-c64147b8d7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff47380>]}
[0m15:38:23.321279 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/manifest.json
[0m15:38:23.324832 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/semantic_manifest.json
[0m15:38:23.360001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a31a718-472c-459c-b187-c64147b8d7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110034560>]}
[0m15:38:23.360791 [info ] [MainThread]: Found 3 seeds, 504 macros
[0m15:38:23.361511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a31a718-472c-459c-b187-c64147b8d7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11006f2c0>]}
[0m15:38:23.364516 [info ] [MainThread]: 
[0m15:38:23.365405 [info ] [MainThread]: Concurrency: 4 threads (target='fabric-dev')
[0m15:38:23.366726 [info ] [MainThread]: 
[0m15:38:23.369559 [debug] [MainThread]: Acquiring new fabric connection 'master'
[0m15:38:23.391142 [debug] [ThreadPool]: Acquiring new fabric connection 'list_jaffle_warehouse'
[0m15:38:23.434950 [debug] [ThreadPool]: dbt-fabric
[0m15:38:23.435950 [debug] [ThreadPool]: Using fabric connection "list_jaffle_warehouse"
[0m15:38:23.436801 [debug] [ThreadPool]: On list_jaffle_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "connection_name": "list_jaffle_warehouse"} */
USE [jaffle_warehouse];
    select  name as [schema]
    from sys.schemas  
    OPTION (LABEL = 'dbt-fabric-dw');

  
[0m15:38:23.437505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:23.438336 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m15:38:24.364610 [debug] [ThreadPool]: fabric adapter: Connected to db: jaffle_warehouse
[0m15:38:24.391476 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m15:38:24.396204 [debug] [ThreadPool]: On list_jaffle_warehouse: Close
[0m15:38:24.398333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_warehouse, now create_jaffle_warehouse_jaffle_training)
[0m15:38:24.400540 [debug] [ThreadPool]: Creating schema "database: "jaffle_warehouse"
schema: "jaffle_training"
"
[0m15:38:24.409738 [debug] [ThreadPool]: Using fabric connection "create_jaffle_warehouse_jaffle_training"
[0m15:38:24.410358 [debug] [ThreadPool]: On create_jaffle_warehouse_jaffle_training: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "connection_name": "create_jaffle_warehouse_jaffle_training"} */
USE [jaffle_warehouse];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'jaffle_training')
    BEGIN
    EXEC('CREATE SCHEMA [jaffle_training]')
    END
  
[0m15:38:24.410848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:24.411393 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m15:38:24.411998 [debug] [ThreadPool]: fabric adapter: Connected to db: jaffle_warehouse
[0m15:38:24.448800 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:38:24.450838 [debug] [ThreadPool]: On create_jaffle_warehouse_jaffle_training: COMMIT
[0m15:38:24.451498 [debug] [ThreadPool]: On create_jaffle_warehouse_jaffle_training: Close
[0m15:38:24.453684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_warehouse_jaffle_training, now list_jaffle_warehouse_jaffle_training)
[0m15:38:24.465010 [debug] [ThreadPool]: dbt-fabric
[0m15:38:24.465847 [debug] [ThreadPool]: Using fabric connection "list_jaffle_warehouse_jaffle_training"
[0m15:38:24.466480 [debug] [ThreadPool]: On list_jaffle_warehouse_jaffle_training: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "connection_name": "list_jaffle_warehouse_jaffle_training"} */
USE [jaffle_warehouse];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t 
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v 
    )
    select * from base
    where [schema] like 'jaffle_training'
    
    OPTION (LABEL = 'dbt-fabric-dw');

  
[0m15:38:24.467063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:24.467725 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m15:38:24.468537 [debug] [ThreadPool]: fabric adapter: Connected to db: jaffle_warehouse
[0m15:38:24.517617 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:38:24.522683 [debug] [ThreadPool]: On list_jaffle_warehouse_jaffle_training: ROLLBACK
[0m15:38:24.523477 [debug] [ThreadPool]: On list_jaffle_warehouse_jaffle_training: Close
[0m15:38:24.524588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a31a718-472c-459c-b187-c64147b8d7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff76120>]}
[0m15:38:24.526081 [debug] [MainThread]: On master: COMMIT
[0m15:38:24.535963 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m15:38:24.537097 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m15:38:24.538171 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m15:38:24.539555 [info ] [Thread-1 (]: 1 of 3 START seed file jaffle_training.raw_customers ........................... [RUN]
[0m15:38:24.540960 [info ] [Thread-2 (]: 2 of 3 START seed file jaffle_training.raw_orders .............................. [RUN]
[0m15:38:24.543184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_warehouse_jaffle_training, now seed.jaffle_shop.raw_customers)
[0m15:38:24.542030 [info ] [Thread-3 (]: 3 of 3 START seed file jaffle_training.raw_payments ............................ [RUN]
[0m15:38:24.544816 [debug] [Thread-2 (]: Acquiring new fabric connection 'seed.jaffle_shop.raw_orders'
[0m15:38:24.552398 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m15:38:24.557366 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m15:38:24.545884 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m15:38:24.548257 [debug] [Thread-3 (]: Acquiring new fabric connection 'seed.jaffle_shop.raw_payments'
[0m15:38:24.574083 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m15:38:24.608679 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m15:38:24.615760 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m15:38:24.677743 [debug] [Thread-2 (]: Using fabric connection "seed.jaffle_shop.raw_orders"
[0m15:38:24.679322 [debug] [Thread-1 (]: Using fabric connection "seed.jaffle_shop.raw_customers"
[0m15:38:24.680063 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "seed.jaffle_shop.raw_orders"} */

    create table "jaffle_warehouse"."jaffle_training"."raw_orders" ("id" int,"user_id" int,"order_date" date,"status" varchar(16))
  
[0m15:38:24.685365 [debug] [Thread-3 (]: Using fabric connection "seed.jaffle_shop.raw_payments"
[0m15:38:24.686144 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "seed.jaffle_shop.raw_customers"} */

    create table "jaffle_warehouse"."jaffle_training"."raw_customers" ("id" int,"first_name" varchar(16),"last_name" varchar(16))
  
[0m15:38:24.686797 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:38:24.687398 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "seed.jaffle_shop.raw_payments"} */

    create table "jaffle_warehouse"."jaffle_training"."raw_payments" ("id" int,"order_id" int,"payment_method" varchar(16),"amount" int)
  
[0m15:38:24.687985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:24.688636 [debug] [Thread-2 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m15:38:24.689233 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:38:24.689876 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m15:38:24.690564 [debug] [Thread-2 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m15:38:24.691206 [debug] [Thread-3 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m15:38:24.892476 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m15:38:24.923149 [debug] [Thread-2 (]: Inserting batches of 400 records
[0m15:38:25.029010 [debug] [Thread-2 (]: dbt-fabric
[0m15:38:25.030154 [debug] [Thread-2 (]: Using fabric connection "seed.jaffle_shop.raw_orders"
[0m15:38:25.030905 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: 
            insert into "jaffle_warehouse"."jaffle_training"."raw_orders" ("id", "user_id", "order_date", "status") values
            (?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?...
[0m15:38:25.317585 [debug] [Thread-3 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m15:38:25.483517 [debug] [Thread-3 (]: SQL status: OK in 1.000 seconds
[0m15:38:25.488514 [debug] [Thread-3 (]: Inserting batches of 400 records
[0m15:38:25.515133 [debug] [Thread-1 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m15:38:25.582433 [debug] [Thread-3 (]: dbt-fabric
[0m15:38:25.583199 [debug] [Thread-3 (]: Using fabric connection "seed.jaffle_shop.raw_payments"
[0m15:38:25.583772 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: 
            insert into "jaffle_warehouse"."jaffle_training"."raw_payments" ("id", "order_id", "payment_method", "amount") values
            (?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?)...
[0m15:38:25.692599 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m15:38:25.697804 [debug] [Thread-1 (]: Inserting batches of 400 records
[0m15:38:25.710481 [debug] [Thread-2 (]: SQL status: OK in 1.000 seconds
[0m15:38:25.749570 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m15:38:25.771179 [debug] [Thread-1 (]: dbt-fabric
[0m15:38:25.772264 [debug] [Thread-1 (]: Using fabric connection "seed.jaffle_shop.raw_customers"
[0m15:38:25.772918 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: 
            insert into "jaffle_warehouse"."jaffle_training"."raw_customers" ("id", "first_name", "last_name") values
            (?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,...
[0m15:38:25.800523 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m15:38:25.803247 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m15:38:25.808543 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a31a718-472c-459c-b187-c64147b8d7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10feb03b0>]}
[0m15:38:25.809465 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file jaffle_training.raw_orders .......................... [[32mINSERT 99[0m in 1.26s]
[0m15:38:25.810493 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m15:38:26.196092 [debug] [Thread-3 (]: SQL status: OK in 1.000 seconds
[0m15:38:26.217128 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m15:38:26.223224 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: COMMIT
[0m15:38:26.225075 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m15:38:26.226295 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a31a718-472c-459c-b187-c64147b8d7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110527800>]}
[0m15:38:26.227296 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file jaffle_training.raw_payments ........................ [[32mINSERT 113[0m in 1.68s]
[0m15:38:26.228551 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m15:38:26.234116 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:38:26.255196 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m15:38:26.258474 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m15:38:26.259732 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m15:38:26.260589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a31a718-472c-459c-b187-c64147b8d7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110551910>]}
[0m15:38:26.261674 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file jaffle_training.raw_customers ....................... [[32mINSERT 100[0m in 1.72s]
[0m15:38:26.263157 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m15:38:26.266312 [debug] [MainThread]: On master: COMMIT
[0m15:38:26.267653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:26.269488 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m15:38:26.270338 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m15:38:26.271779 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m15:38:26.272442 [info ] [MainThread]: 
[0m15:38:26.273344 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 2.90 seconds (2.90s).
[0m15:38:26.275662 [debug] [MainThread]: Command end result
[0m15:38:26.328504 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/manifest.json
[0m15:38:26.335173 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/semantic_manifest.json
[0m15:38:26.345579 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rimix/work/kanai/traning/jaffle_shop/target/run_results.json
[0m15:38:26.346232 [info ] [MainThread]: 
[0m15:38:26.347129 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:38:26.347800 [info ] [MainThread]: 
[0m15:38:26.348545 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:38:26.353460 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 6.4337683, "process_in_blocks": "0", "process_kernel_time": 0.758698, "process_mem_max_rss": "134508544", "process_out_blocks": "0", "process_user_time": 6.05054}
[0m15:38:26.354970 [debug] [MainThread]: Command `dbt seed` succeeded at 15:38:26.354741 after 6.44 seconds
[0m15:38:26.355720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9366c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd0bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e088d40>]}
[0m15:38:26.356586 [debug] [MainThread]: Flushing usage events
[0m15:38:27.545330 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:34.623718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108faa330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa9fd0>]}


============================== 17:11:34.635694 | b6b40ba9-1051-4d00-b763-c82a86dded25 ==============================
[0m17:11:34.635694 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:11:34.636984 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'profiles_dir': '.', 'partial_parse': 'True', 'version_check': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'use_colors': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'write_json': 'True', 'log_path': '/Users/rimix/work/kanai/traning/jaffle_shop/logs', 'target_path': 'None'}
[0m17:11:34.642314 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'jaffle_shop'
[0m17:11:34.647605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.15446934, "process_in_blocks": "0", "process_kernel_time": 0.274321, "process_mem_max_rss": "97447936", "process_out_blocks": "0", "process_user_time": 2.177426}
[0m17:11:34.648699 [debug] [MainThread]: Command `dbt run` failed at 17:11:34.648490 after 0.16 seconds
[0m17:11:34.649394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fabcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fabce0>]}
[0m17:11:34.650326 [debug] [MainThread]: Flushing usage events
[0m17:11:35.922169 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:54.069674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113beb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148b66f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148b6210>]}


============================== 17:11:54.078257 | a750f90e-705d-449f-aafe-7a6ebddd9139 ==============================
[0m17:11:54.078257 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:11:54.080264 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'use_experimental_parser': 'False', 'introspect': 'True', 'printer_width': '80', 'target_path': 'None', 'no_print': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_path': '/Users/rimix/work/kanai/traning/jaffle_shop/logs', 'use_colors': 'True', 'log_cache_events': 'False', 'empty': 'False', 'log_format': 'default', 'profiles_dir': '.', 'partial_parse': 'True', 'quiet': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'indirect_selection': 'eager'}
[0m17:11:54.810339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a750f90e-705d-449f-aafe-7a6ebddd9139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149b3b00>]}
[0m17:11:54.965083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a750f90e-705d-449f-aafe-7a6ebddd9139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f0f800>]}
[0m17:11:54.966658 [info ] [MainThread]: Registered adapter: fabric=1.9.8
[0m17:11:55.243720 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:11:55.411750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m17:11:55.412638 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/stg_payments.sql
[0m17:11:55.413699 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/stg_customers.sql
[0m17:11:55.414248 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/mart/customers.sql
[0m17:11:55.414773 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/mart/orders.sql
[0m17:11:55.415262 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/stg_orders.sql
[0m17:11:55.925037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a750f90e-705d-449f-aafe-7a6ebddd9139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11554e570>]}
[0m17:11:56.064978 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/manifest.json
[0m17:11:56.072396 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/semantic_manifest.json
[0m17:11:56.237624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a750f90e-705d-449f-aafe-7a6ebddd9139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154c24e0>]}
[0m17:11:56.239021 [info ] [MainThread]: Found 3 seeds, 5 models, 504 macros
[0m17:11:56.240648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a750f90e-705d-449f-aafe-7a6ebddd9139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f7e00>]}
[0m17:11:56.244808 [info ] [MainThread]: 
[0m17:11:56.246393 [info ] [MainThread]: Concurrency: 4 threads (target='fabric-dev')
[0m17:11:56.248465 [info ] [MainThread]: 
[0m17:11:56.250215 [debug] [MainThread]: Acquiring new fabric connection 'master'
[0m17:11:56.267932 [debug] [ThreadPool]: Acquiring new fabric connection 'list_jaffle_warehouse'
[0m17:11:56.312084 [debug] [ThreadPool]: dbt-fabric
[0m17:11:56.313103 [debug] [ThreadPool]: Using fabric connection "list_jaffle_warehouse"
[0m17:11:56.316252 [debug] [ThreadPool]: On list_jaffle_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "connection_name": "list_jaffle_warehouse"} */
USE [jaffle_warehouse];
    select  name as [schema]
    from sys.schemas  
    OPTION (LABEL = 'dbt-fabric-dw');

  
[0m17:11:56.316913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:56.317618 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:12:01.326916 [debug] [ThreadPool]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:12:01.328354 [warn ] [ThreadPool]: fabric adapter: No workspace_id provided; skipping snapshot management.
[0m17:12:01.349014 [debug] [ThreadPool]: SQL status: OK in 5.000 seconds
[0m17:12:01.358891 [debug] [ThreadPool]: On list_jaffle_warehouse: Close
[0m17:12:01.361617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_warehouse, now list_jaffle_warehouse_jaffle_training)
[0m17:12:01.374900 [debug] [ThreadPool]: dbt-fabric
[0m17:12:01.376267 [debug] [ThreadPool]: Using fabric connection "list_jaffle_warehouse_jaffle_training"
[0m17:12:01.377265 [debug] [ThreadPool]: On list_jaffle_warehouse_jaffle_training: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "connection_name": "list_jaffle_warehouse_jaffle_training"} */
USE [jaffle_warehouse];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t 
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v 
    )
    select * from base
    where [schema] like 'jaffle_training'
    
    OPTION (LABEL = 'dbt-fabric-dw');

  
[0m17:12:01.377996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:01.378669 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:12:01.379380 [debug] [ThreadPool]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:12:01.488269 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:01.494563 [debug] [ThreadPool]: On list_jaffle_warehouse_jaffle_training: ROLLBACK
[0m17:12:01.495503 [debug] [ThreadPool]: On list_jaffle_warehouse_jaffle_training: Close
[0m17:12:01.499297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a750f90e-705d-449f-aafe-7a6ebddd9139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130f8380>]}
[0m17:12:01.500174 [debug] [MainThread]: On master: COMMIT
[0m17:12:01.505243 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m17:12:01.506189 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m17:12:01.507034 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m17:12:01.508086 [info ] [Thread-1 (]: 1 of 5 START sql view model jaffle_training.stg_customers ...................... [RUN]
[0m17:12:01.509269 [info ] [Thread-2 (]: 2 of 5 START sql view model jaffle_training.stg_orders ......................... [RUN]
[0m17:12:01.510312 [info ] [Thread-3 (]: 3 of 5 START sql view model jaffle_training.stg_payments ....................... [RUN]
[0m17:12:01.511195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_warehouse_jaffle_training, now model.jaffle_shop.stg_customers)
[0m17:12:01.512092 [debug] [Thread-2 (]: Acquiring new fabric connection 'model.jaffle_shop.stg_orders'
[0m17:12:01.512906 [debug] [Thread-3 (]: Acquiring new fabric connection 'model.jaffle_shop.stg_payments'
[0m17:12:01.514157 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m17:12:01.515292 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m17:12:01.515999 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m17:12:01.529470 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m17:12:01.534943 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m17:12:01.539828 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m17:12:01.542147 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m17:12:01.542950 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m17:12:01.561097 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m17:12:01.622219 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m17:12:01.623909 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m17:12:01.625119 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m17:12:01.627038 [debug] [Thread-3 (]: Using fabric connection "model.jaffle_shop.stg_payments"
[0m17:12:01.627821 [debug] [Thread-2 (]: Using fabric connection "model.jaffle_shop.stg_orders"
[0m17:12:01.628610 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_payments"} */
USE [jaffle_warehouse];
    
    

    EXEC('create view "jaffle_training"."stg_payments" as with source as (
    select * from "jaffle_warehouse"."jaffle_training"."raw_payments"
),

renamed as (
    select
        id as payment_id,
        order_id,
        payment_method,
        amount / 100.0 as amount
    from source
)

select * from renamed;');



[0m17:12:01.629276 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.stg_customers"
[0m17:12:01.630011 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_orders"} */
USE [jaffle_warehouse];
    
    

    EXEC('create view "jaffle_training"."stg_orders" as with source as (
    select * from "jaffle_warehouse"."jaffle_training"."raw_orders"
),

renamed as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status
    from source
)

select * from renamed;');



[0m17:12:01.631795 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:12:01.632973 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_customers"} */
USE [jaffle_warehouse];
    
    

    EXEC('create view "jaffle_training"."stg_customers" as with source as (
    select * from "jaffle_warehouse"."jaffle_training"."raw_customers"
),

renamed as (
    select
        id as customer_id,
        first_name,
        last_name
    from source
)

select * from renamed;');



[0m17:12:01.635290 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:12:01.636248 [debug] [Thread-3 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:12:01.637153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:01.638051 [debug] [Thread-2 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:12:01.639236 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:12:01.640286 [debug] [Thread-3 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:12:01.683738 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:12:01.720440 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m17:12:01.723930 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m17:12:01.727060 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a750f90e-705d-449f-aafe-7a6ebddd9139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154daea0>]}
[0m17:12:01.728094 [info ] [Thread-3 (]: 3 of 5 OK created sql view model jaffle_training.stg_payments .................. [[32mOK[0m in 0.21s]
[0m17:12:01.729073 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m17:12:02.786229 [debug] [Thread-1 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:12:02.788761 [debug] [Thread-2 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:12:02.811691 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m17:12:02.814927 [debug] [Thread-2 (]: SQL status: OK in 1.000 seconds
[0m17:12:02.817446 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m17:12:02.821596 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m17:12:02.824530 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m17:12:02.826533 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m17:12:02.827625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a750f90e-705d-449f-aafe-7a6ebddd9139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151b9d60>]}
[0m17:12:02.828710 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a750f90e-705d-449f-aafe-7a6ebddd9139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151b85c0>]}
[0m17:12:02.832172 [info ] [Thread-1 (]: 1 of 5 OK created sql view model jaffle_training.stg_customers ................. [[32mOK[0m in 1.32s]
[0m17:12:02.835941 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m17:12:02.833803 [info ] [Thread-2 (]: 2 of 5 OK created sql view model jaffle_training.stg_orders .................... [[32mOK[0m in 1.32s]
[0m17:12:02.837990 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m17:12:02.840686 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m17:12:02.842242 [debug] [Thread-3 (]: Began running node model.jaffle_shop.orders
[0m17:12:02.843718 [info ] [Thread-4 (]: 4 of 5 START sql table model jaffle_training.customers ......................... [RUN]
[0m17:12:02.848897 [info ] [Thread-3 (]: 5 of 5 START sql table model jaffle_training.orders ............................ [RUN]
[0m17:12:02.851233 [debug] [Thread-4 (]: Acquiring new fabric connection 'model.jaffle_shop.customers'
[0m17:12:02.852104 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.orders)
[0m17:12:02.852873 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m17:12:02.853607 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.orders
[0m17:12:02.861169 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m17:12:02.869234 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m17:12:02.873380 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m17:12:02.906842 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.orders
[0m17:12:02.985531 [debug] [Thread-4 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."customers__dbt_temp"
[0m17:12:02.988440 [debug] [Thread-3 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."orders__dbt_temp"
[0m17:12:03.010387 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:03.011899 [debug] [Thread-3 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:03.012696 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

      
    USE [jaffle_warehouse];
    EXEC('DROP table IF EXISTS "jaffle_training"."customers__dbt_temp";');

[0m17:12:03.014589 [debug] [Thread-3 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

      
    USE [jaffle_warehouse];
    EXEC('DROP table IF EXISTS "jaffle_training"."orders__dbt_temp";');

[0m17:12:03.015420 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:12:03.016207 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:12:03.026009 [debug] [Thread-4 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:12:03.028857 [debug] [Thread-3 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:12:03.749313 [debug] [Thread-4 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:12:03.762749 [debug] [Thread-4 (]: SQL status: OK in 1.000 seconds
[0m17:12:03.769525 [debug] [Thread-4 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."customers__dbt_temp__dbt_tmp_vw"
[0m17:12:03.771549 [debug] [Thread-4 (]: dbt-fabric
[0m17:12:03.772576 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:03.773668 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'customers__dbt_temp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:03.883667 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:03.889190 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:03.890569 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."customers__dbt_temp__dbt_tmp_vw";');

[0m17:12:03.904029 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:03.926189 [debug] [Thread-4 (]: dbt-fabric
[0m17:12:03.931744 [debug] [Thread-4 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."customers__dbt_temp__dbt_tmp_vw"
[0m17:12:03.933714 [debug] [Thread-4 (]: dbt-fabric
[0m17:12:03.934578 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:03.935298 [debug] [Thread-3 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:12:03.936045 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'customers__dbt_temp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:03.949892 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:03.954242 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:03.955712 [debug] [Thread-3 (]: SQL status: OK in 1.000 seconds
[0m17:12:03.957002 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."customers__dbt_temp__dbt_tmp_vw";');

[0m17:12:03.962538 [debug] [Thread-3 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."orders__dbt_temp__dbt_tmp_vw"
[0m17:12:03.965317 [debug] [Thread-3 (]: dbt-fabric
[0m17:12:03.966231 [debug] [Thread-3 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:03.966982 [debug] [Thread-3 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'orders__dbt_temp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:03.981591 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:03.986218 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m17:12:03.989018 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:03.990384 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

  
    
    
    USE [jaffle_warehouse];
    
    

    EXEC('create view "jaffle_training"."customers__dbt_temp__dbt_tmp_vw" as with customers as (
    select * from "jaffle_warehouse"."jaffle_training"."stg_customers"
),

orders as (
    select * from "jaffle_warehouse"."jaffle_training"."stg_orders"
),

payments as (
    select * from "jaffle_warehouse"."jaffle_training"."stg_payments"
),

customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders
    from orders
    group by customer_id
),

customer_payments as (
    select
        orders.customer_id,
        sum(payments.amount) as total_amount
    from payments
    left join orders on payments.order_id = orders.order_id
    group by orders.customer_id
),

final as (
    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_payments.total_amount, 0) as customer_lifetime_value
    from customers
    left join customer_orders on customers.customer_id = customer_orders.customer_id
    left join customer_payments on customers.customer_id = customer_payments.customer_id
)

select * from final;');




    
    
            EXEC('CREATE TABLE "jaffle_warehouse"."jaffle_training"."customers__dbt_temp" AS SELECT * FROM "jaffle_warehouse"."jaffle_training"."customers__dbt_temp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-fabric-dw'');
');
        

    

  
  
[0m17:12:03.991542 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:12:03.994422 [debug] [Thread-3 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:03.995142 [debug] [Thread-3 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."orders__dbt_temp__dbt_tmp_vw";');

[0m17:12:04.017081 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:12:04.021831 [debug] [Thread-3 (]: dbt-fabric
[0m17:12:04.028480 [debug] [Thread-3 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."orders__dbt_temp__dbt_tmp_vw"
[0m17:12:04.031013 [debug] [Thread-3 (]: dbt-fabric
[0m17:12:04.031880 [debug] [Thread-3 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:04.032588 [debug] [Thread-3 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'orders__dbt_temp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:04.053037 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:12:04.059183 [debug] [Thread-3 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:04.060425 [debug] [Thread-3 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."orders__dbt_temp__dbt_tmp_vw";');

[0m17:12:04.074548 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:12:04.082687 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.orders"
[0m17:12:04.084017 [debug] [Thread-3 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:04.084852 [debug] [Thread-3 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

  
    
    
    USE [jaffle_warehouse];
    
    

    EXEC('create view "jaffle_training"."orders__dbt_temp__dbt_tmp_vw" as with orders as (
    select * from "jaffle_warehouse"."jaffle_training"."stg_orders"
),

payments as (
    select * from "jaffle_warehouse"."jaffle_training"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum(case when payment_method = ''credit_card'' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = ''coupon'' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = ''bank_transfer'' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = ''gift_card'' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount
    from payments
    group by order_id
),

final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,
        coalesce(order_payments.credit_card_amount, 0) as credit_card_amount,
        coalesce(order_payments.coupon_amount, 0) as coupon_amount,
        coalesce(order_payments.bank_transfer_amount, 0) as bank_transfer_amount,
        coalesce(order_payments.gift_card_amount, 0) as gift_card_amount,
        coalesce(order_payments.total_amount, 0) as total_amount
    from orders
    left join order_payments on orders.order_id = order_payments.order_id
)

select * from final;');




    
    
            EXEC('CREATE TABLE "jaffle_warehouse"."jaffle_training"."orders__dbt_temp" AS SELECT * FROM "jaffle_warehouse"."jaffle_training"."orders__dbt_temp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-fabric-dw'');
');
        

    

  
  
[0m17:12:12.079581 [debug] [Thread-4 (]: SQL status: OK in 8.000 seconds
[0m17:12:12.095524 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:12.096470 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */
USE [jaffle_warehouse];
      EXEC sp_rename 'jaffle_training.customers__dbt_temp', 'customers'
[0m17:12:12.237343 [debug] [Thread-3 (]: SQL status: OK in 8.000 seconds
[0m17:12:12.248347 [debug] [Thread-3 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:12.249204 [debug] [Thread-3 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */
USE [jaffle_warehouse];
      EXEC sp_rename 'jaffle_training.orders__dbt_temp', 'orders'
[0m17:12:13.150277 [debug] [Thread-4 (]: SQL status: OK in 1.000 seconds
[0m17:12:13.151894 [debug] [Thread-3 (]: SQL status: OK in 1.000 seconds
[0m17:12:13.162562 [debug] [Thread-4 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."customers__dbt_temp__dbt_tmp_vw"
[0m17:12:13.165061 [debug] [Thread-4 (]: dbt-fabric
[0m17:12:13.169204 [debug] [Thread-3 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."orders__dbt_temp__dbt_tmp_vw"
[0m17:12:13.170009 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:13.171820 [debug] [Thread-3 (]: dbt-fabric
[0m17:12:13.173099 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'customers__dbt_temp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:13.174078 [debug] [Thread-3 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:13.175077 [debug] [Thread-3 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'orders__dbt_temp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:13.187672 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:13.189678 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:12:13.194716 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:13.195985 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."customers__dbt_temp__dbt_tmp_vw";');

[0m17:12:13.199797 [debug] [Thread-3 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:13.200675 [debug] [Thread-3 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."orders__dbt_temp__dbt_tmp_vw";');

[0m17:12:13.221836 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:13.227546 [debug] [Thread-4 (]: On model.jaffle_shop.customers: COMMIT
[0m17:12:13.235129 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:12:13.242526 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m17:12:13.243461 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a750f90e-705d-449f-aafe-7a6ebddd9139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115737560>]}
[0m17:12:13.244509 [info ] [Thread-4 (]: 4 of 5 OK created sql table model jaffle_training.customers .................... [[32mOK[0m in 10.39s]
[0m17:12:13.246158 [debug] [Thread-3 (]: On model.jaffle_shop.orders: COMMIT
[0m17:12:13.247549 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m17:12:13.249415 [debug] [Thread-3 (]: On model.jaffle_shop.orders: Close
[0m17:12:13.250502 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a750f90e-705d-449f-aafe-7a6ebddd9139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115728f50>]}
[0m17:12:13.251509 [info ] [Thread-3 (]: 5 of 5 OK created sql table model jaffle_training.orders ....................... [[32mOK[0m in 10.40s]
[0m17:12:13.252680 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.orders
[0m17:12:13.254667 [debug] [MainThread]: On master: COMMIT
[0m17:12:13.255541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:13.256532 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m17:12:13.257109 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m17:12:13.257684 [debug] [MainThread]: Connection 'model.jaffle_shop.orders' was properly closed.
[0m17:12:13.258208 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m17:12:13.258873 [info ] [MainThread]: 
[0m17:12:13.259489 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 17.01 seconds (17.01s).
[0m17:12:13.261663 [debug] [MainThread]: Command end result
[0m17:12:13.295374 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/manifest.json
[0m17:12:13.299686 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/semantic_manifest.json
[0m17:12:13.310147 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rimix/work/kanai/traning/jaffle_shop/target/run_results.json
[0m17:12:13.310728 [info ] [MainThread]: 
[0m17:12:13.311343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:12:13.311895 [info ] [MainThread]: 
[0m17:12:13.312488 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m17:12:13.315601 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.395, "process_in_blocks": "0", "process_kernel_time": 0.750796, "process_mem_max_rss": "134746112", "process_out_blocks": "0", "process_user_time": 5.452026}
[0m17:12:13.316653 [debug] [MainThread]: Command `dbt run` succeeded at 17:12:13.316464 after 19.40 seconds
[0m17:12:13.317321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114112180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122491c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b877a0>]}
[0m17:12:13.317962 [debug] [MainThread]: Flushing usage events
[0m17:12:14.227048 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:46.513153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10640f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ba450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ba0f0>]}


============================== 17:12:46.522919 | b968e613-7996-437d-9e80-b6516c80b99f ==============================
[0m17:12:46.522919 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:12:46.524082 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/rimix/work/kanai/traning/jaffle_shop', 'indirect_selection': 'eager', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'log_path': '/Users/rimix/work/kanai/traning/jaffle_shop/logs', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'printer_width': '80', 'fail_fast': 'False', 'write_json': 'True', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'debug': 'False'}
[0m17:12:47.085570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b968e613-7996-437d-9e80-b6516c80b99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107133ce0>]}
[0m17:12:47.191201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b968e613-7996-437d-9e80-b6516c80b99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea1c40>]}
[0m17:12:47.192166 [info ] [MainThread]: Registered adapter: fabric=1.9.8
[0m17:12:47.405580 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:12:47.583798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:12:47.584417 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:12:47.584865 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:12:47.643958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b968e613-7996-437d-9e80-b6516c80b99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10808d7f0>]}
[0m17:12:47.748663 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/manifest.json
[0m17:12:47.751985 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/semantic_manifest.json
[0m17:12:47.785622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b968e613-7996-437d-9e80-b6516c80b99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f0080>]}
[0m17:12:47.786631 [info ] [MainThread]: Found 3 seeds, 5 models, 504 macros
[0m17:12:47.787404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b968e613-7996-437d-9e80-b6516c80b99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e96d0>]}
[0m17:12:47.790897 [info ] [MainThread]: 
[0m17:12:47.792099 [info ] [MainThread]: Concurrency: 4 threads (target='fabric-dev')
[0m17:12:47.793687 [info ] [MainThread]: 
[0m17:12:47.795192 [debug] [MainThread]: Acquiring new fabric connection 'master'
[0m17:12:47.811251 [debug] [ThreadPool]: Acquiring new fabric connection 'list_jaffle_warehouse'
[0m17:12:47.854708 [debug] [ThreadPool]: dbt-fabric
[0m17:12:47.855644 [debug] [ThreadPool]: Using fabric connection "list_jaffle_warehouse"
[0m17:12:47.856306 [debug] [ThreadPool]: On list_jaffle_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "connection_name": "list_jaffle_warehouse"} */
USE [jaffle_warehouse];
    select  name as [schema]
    from sys.schemas  
    OPTION (LABEL = 'dbt-fabric-dw');

  
[0m17:12:47.856930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:47.857700 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:12:48.568181 [debug] [ThreadPool]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:12:48.569788 [warn ] [ThreadPool]: fabric adapter: No workspace_id provided; skipping snapshot management.
[0m17:12:48.583165 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m17:12:48.587233 [debug] [ThreadPool]: On list_jaffle_warehouse: Close
[0m17:12:48.590238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_warehouse, now list_jaffle_warehouse_jaffle_training)
[0m17:12:48.608609 [debug] [ThreadPool]: dbt-fabric
[0m17:12:48.609465 [debug] [ThreadPool]: Using fabric connection "list_jaffle_warehouse_jaffle_training"
[0m17:12:48.610147 [debug] [ThreadPool]: On list_jaffle_warehouse_jaffle_training: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "connection_name": "list_jaffle_warehouse_jaffle_training"} */
USE [jaffle_warehouse];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t 
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v 
    )
    select * from base
    where [schema] like 'jaffle_training'
    
    OPTION (LABEL = 'dbt-fabric-dw');

  
[0m17:12:48.610827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:48.611736 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:12:48.612521 [debug] [ThreadPool]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:12:48.645087 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:48.650977 [debug] [ThreadPool]: On list_jaffle_warehouse_jaffle_training: ROLLBACK
[0m17:12:48.651946 [debug] [ThreadPool]: On list_jaffle_warehouse_jaffle_training: Close
[0m17:12:48.656175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b968e613-7996-437d-9e80-b6516c80b99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10775de80>]}
[0m17:12:48.657242 [debug] [MainThread]: On master: COMMIT
[0m17:12:48.662233 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m17:12:48.663074 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m17:12:48.663688 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m17:12:48.665250 [info ] [Thread-1 (]: 1 of 5 START sql view model jaffle_training.stg_customers ...................... [RUN]
[0m17:12:48.666427 [info ] [Thread-2 (]: 2 of 5 START sql view model jaffle_training.stg_orders ......................... [RUN]
[0m17:12:48.667458 [info ] [Thread-3 (]: 3 of 5 START sql view model jaffle_training.stg_payments ....................... [RUN]
[0m17:12:48.668401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_warehouse_jaffle_training, now model.jaffle_shop.stg_customers)
[0m17:12:48.669287 [debug] [Thread-2 (]: Acquiring new fabric connection 'model.jaffle_shop.stg_orders'
[0m17:12:48.670357 [debug] [Thread-3 (]: Acquiring new fabric connection 'model.jaffle_shop.stg_payments'
[0m17:12:48.671068 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m17:12:48.672934 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m17:12:48.673981 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m17:12:48.687616 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m17:12:48.692919 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m17:12:48.703888 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m17:12:48.705610 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m17:12:48.706399 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m17:12:48.707109 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m17:12:48.750554 [debug] [Thread-1 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."stg_customers__dbt_backup"
[0m17:12:48.760576 [debug] [Thread-2 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."stg_orders__dbt_backup"
[0m17:12:48.769604 [debug] [Thread-3 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."stg_payments__dbt_backup"
[0m17:12:48.777249 [debug] [Thread-1 (]: dbt-fabric
[0m17:12:48.778938 [debug] [Thread-2 (]: dbt-fabric
[0m17:12:48.780918 [debug] [Thread-3 (]: dbt-fabric
[0m17:12:48.781906 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.stg_customers"
[0m17:12:48.782703 [debug] [Thread-2 (]: Using fabric connection "model.jaffle_shop.stg_orders"
[0m17:12:48.783460 [debug] [Thread-3 (]: Using fabric connection "model.jaffle_shop.stg_payments"
[0m17:12:48.784148 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_customers"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:48.784869 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_orders"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'stg_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:48.785746 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_payments"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'stg_payments__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:48.786433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:48.787043 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:12:48.787641 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:12:48.788423 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:12:48.789275 [debug] [Thread-2 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:12:48.790118 [debug] [Thread-3 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:12:48.791030 [debug] [Thread-1 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:12:48.818366 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:48.821168 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.stg_customers"
[0m17:12:48.821813 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_customers"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."stg_customers__dbt_backup";');

[0m17:12:48.833968 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:48.849781 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.stg_customers"
[0m17:12:48.850571 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_customers"} */
USE [jaffle_warehouse];
      EXEC sp_rename 'jaffle_training.stg_customers', 'stg_customers__dbt_backup'
[0m17:12:48.994424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:49.018040 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m17:12:49.019582 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.stg_customers"
[0m17:12:49.020264 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_customers"} */
USE [jaffle_warehouse];
    
    

    EXEC('create view "jaffle_training"."stg_customers" as with source as (
    select * from "jaffle_warehouse"."jaffle_training"."raw_customers"
),

renamed as (
    select
        id as customer_id,
        first_name,
        last_name
    from source
)

select * from renamed;');



[0m17:12:49.046068 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:49.075777 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m17:12:49.079636 [debug] [Thread-1 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."stg_customers__dbt_backup"
[0m17:12:49.081039 [debug] [Thread-1 (]: dbt-fabric
[0m17:12:49.084047 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.stg_customers"
[0m17:12:49.084825 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_customers"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'stg_customers__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:49.099906 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:49.104732 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.stg_customers"
[0m17:12:49.106417 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_customers"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."stg_customers__dbt_backup";');

[0m17:12:49.135563 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:49.144846 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: ROLLBACK
[0m17:12:49.146417 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m17:12:49.151589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b968e613-7996-437d-9e80-b6516c80b99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105001130>]}
[0m17:12:49.152980 [info ] [Thread-1 (]: 1 of 5 OK created sql view model jaffle_training.stg_customers ................. [[32mOK[0m in 0.48s]
[0m17:12:49.154148 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m17:12:49.309806 [debug] [Thread-3 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:12:49.339635 [debug] [Thread-2 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:12:49.341943 [debug] [Thread-3 (]: SQL status: OK in 1.000 seconds
[0m17:12:49.347109 [debug] [Thread-3 (]: Using fabric connection "model.jaffle_shop.stg_payments"
[0m17:12:49.348598 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_payments"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."stg_payments__dbt_backup";');

[0m17:12:49.362370 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:12:49.460751 [debug] [Thread-3 (]: Using fabric connection "model.jaffle_shop.stg_payments"
[0m17:12:49.461744 [debug] [Thread-2 (]: SQL status: OK in 1.000 seconds
[0m17:12:49.463094 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_payments"} */
USE [jaffle_warehouse];
      EXEC sp_rename 'jaffle_training.stg_payments', 'stg_payments__dbt_backup'
[0m17:12:49.466863 [debug] [Thread-2 (]: Using fabric connection "model.jaffle_shop.stg_orders"
[0m17:12:49.468135 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_orders"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."stg_orders__dbt_backup";');

[0m17:12:49.485163 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:12:49.495471 [debug] [Thread-2 (]: Using fabric connection "model.jaffle_shop.stg_orders"
[0m17:12:49.496393 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_orders"} */
USE [jaffle_warehouse];
      EXEC sp_rename 'jaffle_training.stg_orders', 'stg_orders__dbt_backup'
[0m17:12:49.714562 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:12:49.722210 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m17:12:49.723951 [debug] [Thread-3 (]: Using fabric connection "model.jaffle_shop.stg_payments"
[0m17:12:49.725542 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_payments"} */
USE [jaffle_warehouse];
    
    

    EXEC('create view "jaffle_training"."stg_payments" as with source as (
    select * from "jaffle_warehouse"."jaffle_training"."raw_payments"
),

renamed as (
    select
        id as payment_id,
        order_id,
        payment_method,
        amount / 100.0 as amount
    from source
)

select * from renamed;');



[0m17:12:49.729857 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:12:49.732897 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m17:12:49.734153 [debug] [Thread-2 (]: Using fabric connection "model.jaffle_shop.stg_orders"
[0m17:12:49.734901 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_orders"} */
USE [jaffle_warehouse];
    
    

    EXEC('create view "jaffle_training"."stg_orders" as with source as (
    select * from "jaffle_warehouse"."jaffle_training"."raw_orders"
),

renamed as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status
    from source
)

select * from renamed;');



[0m17:12:49.753526 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:12:49.759524 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m17:12:49.760884 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:12:49.765758 [debug] [Thread-3 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."stg_payments__dbt_backup"
[0m17:12:49.768826 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m17:12:49.770211 [debug] [Thread-3 (]: dbt-fabric
[0m17:12:49.774231 [debug] [Thread-2 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."stg_orders__dbt_backup"
[0m17:12:49.775080 [debug] [Thread-3 (]: Using fabric connection "model.jaffle_shop.stg_payments"
[0m17:12:49.776916 [debug] [Thread-2 (]: dbt-fabric
[0m17:12:49.777765 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_payments"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'stg_payments__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:49.778721 [debug] [Thread-2 (]: Using fabric connection "model.jaffle_shop.stg_orders"
[0m17:12:49.779648 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_orders"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'stg_orders__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:49.793695 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:12:49.795429 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:12:49.802527 [debug] [Thread-3 (]: Using fabric connection "model.jaffle_shop.stg_payments"
[0m17:12:49.803624 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_payments"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."stg_payments__dbt_backup";');

[0m17:12:49.804936 [debug] [Thread-2 (]: Using fabric connection "model.jaffle_shop.stg_orders"
[0m17:12:49.805800 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_orders"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."stg_orders__dbt_backup";');

[0m17:12:49.830666 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:12:49.832561 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:12:49.836927 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: ROLLBACK
[0m17:12:49.840148 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: ROLLBACK
[0m17:12:49.841299 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m17:12:49.842057 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m17:12:49.843091 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b968e613-7996-437d-9e80-b6516c80b99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084ddd90>]}
[0m17:12:49.844007 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b968e613-7996-437d-9e80-b6516c80b99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e2780>]}
[0m17:12:49.845110 [info ] [Thread-3 (]: 3 of 5 OK created sql view model jaffle_training.stg_payments .................. [[32mOK[0m in 1.17s]
[0m17:12:49.846444 [info ] [Thread-2 (]: 2 of 5 OK created sql view model jaffle_training.stg_orders .................... [[32mOK[0m in 1.17s]
[0m17:12:49.847637 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m17:12:49.848833 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m17:12:49.850319 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m17:12:49.851064 [debug] [Thread-1 (]: Began running node model.jaffle_shop.orders
[0m17:12:49.852713 [info ] [Thread-4 (]: 4 of 5 START sql table model jaffle_training.customers ......................... [RUN]
[0m17:12:49.855460 [info ] [Thread-1 (]: 5 of 5 START sql table model jaffle_training.orders ............................ [RUN]
[0m17:12:49.856926 [debug] [Thread-4 (]: Acquiring new fabric connection 'model.jaffle_shop.customers'
[0m17:12:49.857776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.orders)
[0m17:12:49.858506 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m17:12:49.859222 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.orders
[0m17:12:49.867009 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m17:12:49.879113 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m17:12:49.882279 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.orders
[0m17:12:49.895875 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m17:12:49.947270 [debug] [Thread-1 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."orders__dbt_temp"
[0m17:12:49.961799 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:49.962546 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

      
    USE [jaffle_warehouse];
    EXEC('DROP table IF EXISTS "jaffle_training"."orders__dbt_temp";');

[0m17:12:49.966380 [debug] [Thread-4 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."customers__dbt_temp"
[0m17:12:49.966958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:49.968224 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:49.968918 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:12:49.969963 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

      
    USE [jaffle_warehouse];
    EXEC('DROP table IF EXISTS "jaffle_training"."customers__dbt_temp";');

[0m17:12:49.970937 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:12:49.971632 [debug] [Thread-1 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:12:49.972219 [debug] [Thread-4 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:12:49.973090 [debug] [Thread-4 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:12:49.984610 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:49.985662 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:50.003147 [debug] [Thread-4 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."customers__dbt_temp__dbt_tmp_vw"
[0m17:12:49.997312 [debug] [Thread-1 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."orders__dbt_temp__dbt_tmp_vw"
[0m17:12:50.004924 [debug] [Thread-4 (]: dbt-fabric
[0m17:12:50.007589 [debug] [Thread-1 (]: dbt-fabric
[0m17:12:50.008728 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:50.010064 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:50.010970 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'customers__dbt_temp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:50.011979 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'orders__dbt_temp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:50.031187 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:50.032810 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:50.036313 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:50.037276 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."orders__dbt_temp__dbt_tmp_vw";');

[0m17:12:50.040020 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:50.040742 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."customers__dbt_temp__dbt_tmp_vw";');

[0m17:12:50.049079 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:50.070236 [debug] [Thread-1 (]: dbt-fabric
[0m17:12:50.071076 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:50.075826 [debug] [Thread-1 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."orders__dbt_temp__dbt_tmp_vw"
[0m17:12:50.078393 [debug] [Thread-4 (]: dbt-fabric
[0m17:12:50.079886 [debug] [Thread-1 (]: dbt-fabric
[0m17:12:50.085748 [debug] [Thread-4 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."customers__dbt_temp__dbt_tmp_vw"
[0m17:12:50.086767 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:50.088157 [debug] [Thread-4 (]: dbt-fabric
[0m17:12:50.088874 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'orders__dbt_temp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:50.089770 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:50.090915 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'customers__dbt_temp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:50.104707 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:50.106221 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:50.112045 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:50.117184 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:50.118669 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."customers__dbt_temp__dbt_tmp_vw";');

[0m17:12:50.119578 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."orders__dbt_temp__dbt_tmp_vw";');

[0m17:12:50.131714 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:50.134667 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:50.140104 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m17:12:50.143655 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.orders"
[0m17:12:50.145146 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:50.145970 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:50.147213 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

  
    
    
    USE [jaffle_warehouse];
    
    

    EXEC('create view "jaffle_training"."orders__dbt_temp__dbt_tmp_vw" as with orders as (
    select * from "jaffle_warehouse"."jaffle_training"."stg_orders"
),

payments as (
    select * from "jaffle_warehouse"."jaffle_training"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum(case when payment_method = ''credit_card'' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = ''coupon'' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = ''bank_transfer'' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = ''gift_card'' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount
    from payments
    group by order_id
),

final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,
        coalesce(order_payments.credit_card_amount, 0) as credit_card_amount,
        coalesce(order_payments.coupon_amount, 0) as coupon_amount,
        coalesce(order_payments.bank_transfer_amount, 0) as bank_transfer_amount,
        coalesce(order_payments.gift_card_amount, 0) as gift_card_amount,
        coalesce(order_payments.total_amount, 0) as total_amount
    from orders
    left join order_payments on orders.order_id = order_payments.order_id
)

select * from final;');




    
    
            EXEC('CREATE TABLE "jaffle_warehouse"."jaffle_training"."orders__dbt_temp" AS SELECT * FROM "jaffle_warehouse"."jaffle_training"."orders__dbt_temp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-fabric-dw'');
');
        

    

  
  
[0m17:12:50.150039 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

  
    
    
    USE [jaffle_warehouse];
    
    

    EXEC('create view "jaffle_training"."customers__dbt_temp__dbt_tmp_vw" as with customers as (
    select * from "jaffle_warehouse"."jaffle_training"."stg_customers"
),

orders as (
    select * from "jaffle_warehouse"."jaffle_training"."stg_orders"
),

payments as (
    select * from "jaffle_warehouse"."jaffle_training"."stg_payments"
),

customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders
    from orders
    group by customer_id
),

customer_payments as (
    select
        orders.customer_id,
        sum(payments.amount) as total_amount
    from payments
    left join orders on payments.order_id = orders.order_id
    group by orders.customer_id
),

final as (
    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_payments.total_amount, 0) as customer_lifetime_value
    from customers
    left join customer_orders on customers.customer_id = customer_orders.customer_id
    left join customer_payments on customers.customer_id = customer_payments.customer_id
)

select * from final;');




    
    
            EXEC('CREATE TABLE "jaffle_warehouse"."jaffle_training"."customers__dbt_temp" AS SELECT * FROM "jaffle_warehouse"."jaffle_training"."customers__dbt_temp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-fabric-dw'');
');
        

    

  
  
[0m17:12:51.018250 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m17:12:51.020416 [debug] [Thread-4 (]: SQL status: OK in 1.000 seconds
[0m17:12:51.028688 [debug] [Thread-1 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."orders__dbt_backup"
[0m17:12:51.037355 [debug] [Thread-4 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."customers__dbt_backup"
[0m17:12:51.038754 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:51.040158 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:51.041332 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

      
    USE [jaffle_warehouse];
    EXEC('DROP table IF EXISTS "jaffle_training"."orders__dbt_backup";');

[0m17:12:51.042598 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

      
    USE [jaffle_warehouse];
    EXEC('DROP table IF EXISTS "jaffle_training"."customers__dbt_backup";');

[0m17:12:51.055310 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:51.056405 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:51.063550 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:51.067624 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */
USE [jaffle_warehouse];
      EXEC sp_rename 'jaffle_training.orders', 'orders__dbt_backup'
[0m17:12:51.075393 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:51.076198 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */
USE [jaffle_warehouse];
      EXEC sp_rename 'jaffle_training.customers', 'customers__dbt_backup'
[0m17:12:51.527365 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:51.529109 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:51.538019 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:51.545525 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:51.546283 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */
USE [jaffle_warehouse];
      EXEC sp_rename 'jaffle_training.customers__dbt_temp', 'customers'
[0m17:12:51.547240 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */
USE [jaffle_warehouse];
      EXEC sp_rename 'jaffle_training.orders__dbt_temp', 'orders'
[0m17:12:51.946327 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:51.951108 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:51.960196 [debug] [Thread-1 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."orders__dbt_backup"
[0m17:12:51.972079 [debug] [Thread-4 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."customers__dbt_backup"
[0m17:12:51.974120 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:51.978159 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:51.979073 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

      
    USE [jaffle_warehouse];
    EXEC('DROP table IF EXISTS "jaffle_training"."orders__dbt_backup";');

[0m17:12:51.979907 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

      
    USE [jaffle_warehouse];
    EXEC('DROP table IF EXISTS "jaffle_training"."customers__dbt_backup";');

[0m17:12:52.019097 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:52.025909 [debug] [Thread-4 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."customers__dbt_temp__dbt_tmp_vw"
[0m17:12:52.027738 [debug] [Thread-4 (]: dbt-fabric
[0m17:12:52.028669 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:52.029557 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:52.038258 [debug] [Thread-1 (]: Applying DROP to: "jaffle_warehouse"."jaffle_training"."orders__dbt_temp__dbt_tmp_vw"
[0m17:12:52.039370 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'customers__dbt_temp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:52.042304 [debug] [Thread-1 (]: dbt-fabric
[0m17:12:52.043598 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:52.044407 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

        USE [jaffle_warehouse];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'jaffle_warehouse'
        and refs.referenced_schema_name = 'jaffle_training'
        and refs.referenced_entity_name = 'orders__dbt_temp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-fabric-dw');

      
[0m17:12:52.065254 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:52.066791 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:52.070278 [debug] [Thread-4 (]: Using fabric connection "model.jaffle_shop.customers"
[0m17:12:52.072896 [debug] [Thread-1 (]: Using fabric connection "model.jaffle_shop.orders"
[0m17:12:52.073759 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."customers__dbt_temp__dbt_tmp_vw";');

[0m17:12:52.074665 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

      
      
    
    USE [jaffle_warehouse];
    EXEC('DROP view IF EXISTS "jaffle_training"."orders__dbt_temp__dbt_tmp_vw";');

[0m17:12:52.101165 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:52.104990 [debug] [Thread-1 (]: On model.jaffle_shop.orders: COMMIT
[0m17:12:52.119527 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:52.116464 [debug] [Thread-1 (]: On model.jaffle_shop.orders: Close
[0m17:12:52.124023 [debug] [Thread-4 (]: On model.jaffle_shop.customers: COMMIT
[0m17:12:52.125380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b968e613-7996-437d-9e80-b6516c80b99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849ec30>]}
[0m17:12:52.127228 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m17:12:52.128270 [info ] [Thread-1 (]: 5 of 5 OK created sql table model jaffle_training.orders ....................... [[32mOK[0m in 2.27s]
[0m17:12:52.129337 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b968e613-7996-437d-9e80-b6516c80b99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d7e00>]}
[0m17:12:52.130355 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.orders
[0m17:12:52.132534 [info ] [Thread-4 (]: 4 of 5 OK created sql table model jaffle_training.customers .................... [[32mOK[0m in 2.27s]
[0m17:12:52.134521 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m17:12:52.138076 [debug] [MainThread]: On master: COMMIT
[0m17:12:52.138879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:52.139415 [debug] [MainThread]: Connection 'model.jaffle_shop.orders' was properly closed.
[0m17:12:52.140056 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m17:12:52.140993 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m17:12:52.142056 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m17:12:52.143334 [info ] [MainThread]: 
[0m17:12:52.144175 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 4.35 seconds (4.35s).
[0m17:12:52.146456 [debug] [MainThread]: Command end result
[0m17:12:52.202264 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/manifest.json
[0m17:12:52.205090 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/semantic_manifest.json
[0m17:12:52.222031 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rimix/work/kanai/traning/jaffle_shop/target/run_results.json
[0m17:12:52.222667 [info ] [MainThread]: 
[0m17:12:52.223458 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:12:52.224297 [info ] [MainThread]: 
[0m17:12:52.225441 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m17:12:52.230905 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.838903, "process_in_blocks": "0", "process_kernel_time": 0.640196, "process_mem_max_rss": "132677632", "process_out_blocks": "0", "process_user_time": 4.548933}
[0m17:12:52.236471 [debug] [MainThread]: Command `dbt run` succeeded at 17:12:52.236159 after 5.84 seconds
[0m17:12:52.237275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106499280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7dac0>]}
[0m17:12:52.237939 [debug] [MainThread]: Flushing usage events
[0m17:12:53.567771 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:15.816718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9563f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110792a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108022d0>]}


============================== 17:18:15.825968 | 3d34d25e-ae4b-4f91-9de6-ff4cdfbe7495 ==============================
[0m17:18:15.825968 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:18:15.827523 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'warn_error': 'None', 'partial_parse': 'True', 'log_format': 'default', 'log_path': '/Users/rimix/work/kanai/traning/jaffle_shop/logs', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'use_colors': 'True', 'printer_width': '80', 'invocation_command': 'dbt test --profiles-dir .', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True'}
[0m17:18:15.835564 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'jaffle_shop'
[0m17:18:15.839407 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.14085926, "process_in_blocks": "0", "process_kernel_time": 0.444152, "process_mem_max_rss": "97370112", "process_out_blocks": "0", "process_user_time": 2.231649}
[0m17:18:15.840452 [debug] [MainThread]: Command `dbt test` failed at 17:18:15.840250 after 0.14 seconds
[0m17:18:15.841262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108025a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108021e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4c9580>]}
[0m17:18:15.844164 [debug] [MainThread]: Flushing usage events
[0m17:18:16.749647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:48.348642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a21d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123b7b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11274cda0>]}


============================== 17:18:48.356694 | e9a29495-79d4-421c-b07e-944cc6d5d559 ==============================
[0m17:18:48.356694 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:18:48.357930 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'empty': 'None', 'target_path': 'None', 'partial_parse': 'True', 'printer_width': '80', 'profiles_dir': '/Users/rimix/work/kanai/traning/jaffle_shop', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_path': '/Users/rimix/work/kanai/traning/jaffle_shop/logs', 'use_colors': 'True', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'debug': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'quiet': 'False'}
[0m17:18:48.990638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9a29495-79d4-421c-b07e-944cc6d5d559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130dfe60>]}
[0m17:18:49.090532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9a29495-79d4-421c-b07e-944cc6d5d559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11310eb70>]}
[0m17:18:49.091465 [info ] [MainThread]: Registered adapter: fabric=1.9.8
[0m17:18:49.297258 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:18:49.506816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:18:49.508370 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/schema.yml
[0m17:18:49.808753 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on 'stg_orders' in
package 'jaffle_shop' (models/staging/schema.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m17:18:49.809642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e9a29495-79d4-421c-b07e-944cc6d5d559', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d43f20>]}
[0m17:18:49.989699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9a29495-79d4-421c-b07e-944cc6d5d559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138af920>]}
[0m17:18:50.218425 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/manifest.json
[0m17:18:50.225857 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/semantic_manifest.json
[0m17:18:50.279439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9a29495-79d4-421c-b07e-944cc6d5d559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c92960>]}
[0m17:18:50.280524 [info ] [MainThread]: Found 3 seeds, 5 models, 7 data tests, 504 macros
[0m17:18:50.283494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9a29495-79d4-421c-b07e-944cc6d5d559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dba720>]}
[0m17:18:50.287490 [info ] [MainThread]: 
[0m17:18:50.289200 [info ] [MainThread]: Concurrency: 4 threads (target='fabric-dev')
[0m17:18:50.290831 [info ] [MainThread]: 
[0m17:18:50.291919 [debug] [MainThread]: Acquiring new fabric connection 'master'
[0m17:18:50.303087 [debug] [ThreadPool]: Acquiring new fabric connection 'list_jaffle_warehouse_jaffle_training'
[0m17:18:50.347991 [debug] [ThreadPool]: dbt-fabric
[0m17:18:50.348944 [debug] [ThreadPool]: Using fabric connection "list_jaffle_warehouse_jaffle_training"
[0m17:18:50.349687 [debug] [ThreadPool]: On list_jaffle_warehouse_jaffle_training: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "connection_name": "list_jaffle_warehouse_jaffle_training"} */
USE [jaffle_warehouse];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t 
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v 
    )
    select * from base
    where [schema] like 'jaffle_training'
    
    OPTION (LABEL = 'dbt-fabric-dw');

  
[0m17:18:50.350702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:50.351552 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:18:51.448052 [debug] [ThreadPool]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:18:51.481353 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m17:18:51.486439 [debug] [ThreadPool]: On list_jaffle_warehouse_jaffle_training: ROLLBACK
[0m17:18:51.487720 [debug] [ThreadPool]: On list_jaffle_warehouse_jaffle_training: Close
[0m17:18:51.492276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9a29495-79d4-421c-b07e-944cc6d5d559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c92270>]}
[0m17:18:51.493136 [debug] [MainThread]: On master: COMMIT
[0m17:18:51.497691 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:18:51.498594 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m17:18:51.499296 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:18:51.499839 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:18:51.500530 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m17:18:51.501225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_warehouse_jaffle_training, now test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad)
[0m17:18:51.501875 [info ] [Thread-2 (]: 2 of 7 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m17:18:51.502596 [info ] [Thread-3 (]: 3 of 7 START test not_null_stg_orders_order_id ................................. [RUN]
[0m17:18:51.503307 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_payments_payment_id ............................. [RUN]
[0m17:18:51.504534 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:18:51.506277 [debug] [Thread-2 (]: Acquiring new fabric connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m17:18:51.507504 [debug] [Thread-3 (]: Acquiring new fabric connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64'
[0m17:18:51.508416 [debug] [Thread-4 (]: Acquiring new fabric connection 'test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075'
[0m17:18:51.534179 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m17:18:51.534850 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:18:51.535535 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:18:51.536194 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m17:18:51.571886 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:18:51.569906 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:18:51.579738 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:18:51.581084 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m17:18:51.604561 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:18:51.627832 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m17:18:51.634784 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m17:18:51.635802 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:18:51.640359 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:18:51.645367 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m17:18:51.649930 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:18:51.651320 [debug] [Thread-1 (]: Using fabric connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m17:18:51.654965 [debug] [Thread-4 (]: Using fabric connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m17:18:51.656136 [debug] [Thread-2 (]: Using fabric connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:18:51.657335 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */

    with test_main_sql as (
  
    
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "jaffle_warehouse"."jaffle_training"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



  
  ),
  dbt_internal_test as (
    select  * from test_main_sql
  )
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from dbt_internal_test
[0m17:18:51.658785 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"} */

    with test_main_sql as (
  
    
    
    



select payment_id
from "jaffle_warehouse"."jaffle_training"."stg_payments"
where payment_id is null



  
  ),
  dbt_internal_test as (
    select  * from test_main_sql
  )
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from dbt_internal_test
[0m17:18:51.660366 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    with test_main_sql as (
  
    
    
    



select customer_id
from "jaffle_warehouse"."jaffle_training"."stg_customers"
where customer_id is null



  
  ),
  dbt_internal_test as (
    select  * from test_main_sql
  )
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from dbt_internal_test
[0m17:18:51.661652 [debug] [Thread-3 (]: Using fabric connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:18:51.666453 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */

    with test_main_sql as (
  
    
    
    



select order_id
from "jaffle_warehouse"."jaffle_training"."stg_orders"
where order_id is null



  
  ),
  dbt_internal_test as (
    select  * from test_main_sql
  )
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from dbt_internal_test
[0m17:18:51.674752 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:18:51.662913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:51.679520 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:18:51.680924 [debug] [Thread-1 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:18:51.664107 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:18:51.683500 [debug] [Thread-4 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:18:51.665284 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:18:51.676145 [debug] [Thread-3 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:18:51.690489 [debug] [Thread-2 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:18:51.971974 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:18:51.983785 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: ROLLBACK
[0m17:18:51.984572 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m17:18:51.985591 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 0.48s]
[0m17:18:51.987088 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:18:51.987931 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:18:51.988712 [info ] [Thread-1 (]: 5 of 7 START test unique_stg_customers_customer_id ............................. [RUN]
[0m17:18:51.989684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m17:18:51.990372 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:18:52.006156 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m17:18:52.007493 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:18:52.015237 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m17:18:52.017184 [debug] [Thread-1 (]: Using fabric connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m17:18:52.019133 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */

    with test_main_sql as (
  
    
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "jaffle_warehouse"."jaffle_training"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  ),
  dbt_internal_test as (
    select  * from test_main_sql
  )
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from dbt_internal_test
[0m17:18:52.023586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:52.024361 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:18:52.351879 [debug] [Thread-2 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:18:52.376224 [debug] [Thread-3 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:18:52.397213 [debug] [Thread-4 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:18:52.418049 [debug] [Thread-2 (]: SQL status: OK in 1.000 seconds
[0m17:18:52.421720 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m17:18:52.422766 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m17:18:52.423987 [info ] [Thread-2 (]: 2 of 7 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.92s]
[0m17:18:52.425314 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:18:52.426081 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:18:52.426883 [info ] [Thread-2 (]: 6 of 7 START test unique_stg_orders_order_id ................................... [RUN]
[0m17:18:52.427901 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m17:18:52.428590 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:18:52.437034 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m17:18:52.438187 [debug] [Thread-3 (]: SQL status: OK in 1.000 seconds
[0m17:18:52.440701 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m17:18:52.441459 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m17:18:52.447108 [info ] [Thread-3 (]: 3 of 7 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.94s]
[0m17:18:52.448295 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:18:52.448980 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:18:52.449820 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m17:18:52.460097 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m17:18:52.461635 [info ] [Thread-3 (]: 7 of 7 START test unique_stg_payments_payment_id ............................... [RUN]
[0m17:18:52.463238 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.unique_stg_payments_payment_id.3744510712)
[0m17:18:52.464094 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m17:18:52.473499 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m17:18:52.474584 [debug] [Thread-2 (]: Using fabric connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m17:18:52.475659 [debug] [Thread-2 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */

    with test_main_sql as (
  
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "jaffle_warehouse"."jaffle_training"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  ),
  dbt_internal_test as (
    select  * from test_main_sql
  )
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from dbt_internal_test
[0m17:18:52.476537 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:52.477193 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m17:18:52.477934 [debug] [Thread-2 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:18:52.484830 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m17:18:52.485762 [debug] [Thread-2 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:18:52.488683 [debug] [Thread-3 (]: Using fabric connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m17:18:52.489649 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"} */

    with test_main_sql as (
  
    
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "jaffle_warehouse"."jaffle_training"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



  
  ),
  dbt_internal_test as (
    select  * from test_main_sql
  )
  select
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from dbt_internal_test
[0m17:18:52.490573 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:52.491627 [debug] [Thread-3 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:18:52.492463 [debug] [Thread-3 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:18:52.536820 [debug] [Thread-1 (]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:18:52.557320 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:18:52.564005 [debug] [Thread-2 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m17:18:52.565057 [debug] [Thread-2 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m17:18:52.566393 [info ] [Thread-2 (]: 6 of 7 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.14s]
[0m17:18:52.567640 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:18:52.595874 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m17:18:52.598849 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m17:18:52.599606 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m17:18:52.602268 [info ] [Thread-1 (]: 5 of 7 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.61s]
[0m17:18:52.606682 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:18:52.640808 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:18:52.643352 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m17:18:52.644170 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: Close
[0m17:18:52.645547 [info ] [Thread-3 (]: 7 of 7 PASS unique_stg_payments_payment_id ..................................... [[32mPASS[0m in 0.18s]
[0m17:18:52.646870 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m17:18:52.731842 [debug] [Thread-4 (]: SQL status: OK in 1.000 seconds
[0m17:18:52.736856 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m17:18:52.737857 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: Close
[0m17:18:52.739186 [info ] [Thread-4 (]: 4 of 7 PASS not_null_stg_payments_payment_id ................................... [[32mPASS[0m in 1.23s]
[0m17:18:52.740732 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m17:18:52.743266 [debug] [MainThread]: On master: COMMIT
[0m17:18:52.744060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:52.744618 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m17:18:52.745166 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m17:18:52.747662 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m17:18:52.748229 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075' was properly closed.
[0m17:18:52.748899 [info ] [MainThread]: 
[0m17:18:52.749789 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m17:18:52.754528 [debug] [MainThread]: Command end result
[0m17:18:52.812183 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/manifest.json
[0m17:18:52.816047 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/semantic_manifest.json
[0m17:18:52.828000 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rimix/work/kanai/traning/jaffle_shop/target/run_results.json
[0m17:18:52.828626 [info ] [MainThread]: 
[0m17:18:52.829368 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:18:52.830263 [info ] [MainThread]: 
[0m17:18:52.831166 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m17:18:52.832348 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:18:52.835659 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.602733, "process_in_blocks": "0", "process_kernel_time": 0.623151, "process_mem_max_rss": "137777152", "process_out_blocks": "0", "process_user_time": 4.643183}
[0m17:18:52.837187 [debug] [MainThread]: Command `dbt test` succeeded at 17:18:52.836946 after 4.60 seconds
[0m17:18:52.838092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f9deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f9e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f9e600>]}
[0m17:18:52.838833 [debug] [MainThread]: Flushing usage events
[0m17:18:53.682528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:19:54.219043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb30260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c26e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3b23f0>]}


============================== 17:19:54.226635 | 8dde7e0d-4c99-4b51-a0cb-830c6bfb5ac9 ==============================
[0m17:19:54.226635 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:19:54.227756 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/rimix/work/kanai/traning/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_colors': 'True', 'debug': 'False', 'profiles_dir': '/Users/rimix/work/kanai/traning/jaffle_shop', 'static_parser': 'True', 'warn_error': 'None', 'write_json': 'True', 'partial_parse': 'True', 'log_format': 'default', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs generate', 'printer_width': '80', 'target_path': 'None'}
[0m17:19:54.775657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dde7e0d-4c99-4b51-a0cb-830c6bfb5ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c05b50>]}
[0m17:19:54.919331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dde7e0d-4c99-4b51-a0cb-830c6bfb5ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c673080>]}
[0m17:19:54.920587 [info ] [MainThread]: Registered adapter: fabric=1.9.8
[0m17:19:55.142289 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:19:55.326659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:19:55.327275 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:19:55.327741 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:19:55.401588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dde7e0d-4c99-4b51-a0cb-830c6bfb5ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc8f020>]}
[0m17:19:55.425131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dde7e0d-4c99-4b51-a0cb-830c6bfb5ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d03a8d0>]}
[0m17:19:55.425918 [info ] [MainThread]: Found 3 seeds, 5 models, 7 data tests, 504 macros
[0m17:19:55.426536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dde7e0d-4c99-4b51-a0cb-830c6bfb5ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cef2300>]}
[0m17:19:55.430099 [info ] [MainThread]: 
[0m17:19:55.430788 [info ] [MainThread]: Concurrency: 4 threads (target='fabric-dev')
[0m17:19:55.431758 [info ] [MainThread]: 
[0m17:19:55.433350 [debug] [MainThread]: Acquiring new fabric connection 'master'
[0m17:19:55.444193 [debug] [ThreadPool]: Acquiring new fabric connection 'list_jaffle_warehouse_jaffle_training'
[0m17:19:55.492483 [debug] [ThreadPool]: dbt-fabric
[0m17:19:55.493364 [debug] [ThreadPool]: Using fabric connection "list_jaffle_warehouse_jaffle_training"
[0m17:19:55.493991 [debug] [ThreadPool]: On list_jaffle_warehouse_jaffle_training: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "connection_name": "list_jaffle_warehouse_jaffle_training"} */
USE [jaffle_warehouse];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t 
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v 
    )
    select * from base
    where [schema] like 'jaffle_training'
    
    OPTION (LABEL = 'dbt-fabric-dw');

  
[0m17:19:55.494602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:55.495278 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:19:56.279777 [debug] [ThreadPool]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:19:56.325331 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m17:19:56.328142 [debug] [ThreadPool]: On list_jaffle_warehouse_jaffle_training: ROLLBACK
[0m17:19:56.328826 [debug] [ThreadPool]: On list_jaffle_warehouse_jaffle_training: Close
[0m17:19:56.331781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dde7e0d-4c99-4b51-a0cb-830c6bfb5ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cdcc50>]}
[0m17:19:56.335824 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m17:19:56.336621 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m17:19:56.337309 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m17:19:56.338319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_warehouse_jaffle_training, now seed.jaffle_shop.raw_customers)
[0m17:19:56.339384 [debug] [Thread-2 (]: Acquiring new fabric connection 'seed.jaffle_shop.raw_orders'
[0m17:19:56.340438 [debug] [Thread-3 (]: Acquiring new fabric connection 'seed.jaffle_shop.raw_payments'
[0m17:19:56.341231 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m17:19:56.341927 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m17:19:56.342605 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m17:19:56.355073 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m17:19:56.360990 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m17:19:56.363743 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m17:19:56.364924 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m17:19:56.365957 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m17:19:56.366998 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m17:19:56.367920 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_customers
[0m17:19:56.368795 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m17:19:56.369599 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_payments
[0m17:19:56.370402 [debug] [Thread-4 (]: Acquiring new fabric connection 'model.jaffle_shop.stg_customers'
[0m17:19:56.371071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_customers, now model.jaffle_shop.stg_orders)
[0m17:19:56.371801 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_orders, now model.jaffle_shop.stg_payments)
[0m17:19:56.372456 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_customers
[0m17:19:56.373084 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m17:19:56.373684 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_payments
[0m17:19:56.378430 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m17:19:56.384765 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m17:19:56.389935 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m17:19:56.391609 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_customers
[0m17:19:56.392291 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m17:19:56.393467 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_customers
[0m17:19:56.394730 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m17:19:56.395321 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_payments
[0m17:19:56.396391 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:19:56.396977 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:19:56.398179 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_payments
[0m17:19:56.398861 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:19:56.399496 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_payments, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m17:19:56.400377 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m17:19:56.401056 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:19:56.402061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad)
[0m17:19:56.403113 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:19:56.404218 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:19:56.405330 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m17:19:56.406024 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:19:56.424467 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:19:56.434520 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m17:19:56.435441 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:19:56.451531 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m17:19:56.461626 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:19:56.463039 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:19:56.463944 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:19:56.465755 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:19:56.466345 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:19:56.467628 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:19:56.468235 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:19:56.468871 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:19:56.470006 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:19:56.470648 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m17:19:56.471794 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:19:56.472451 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m17:19:56.473079 [debug] [Thread-1 (]: Began running node model.jaffle_shop.orders
[0m17:19:56.473735 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now model.jaffle_shop.customers)
[0m17:19:56.474368 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m17:19:56.474950 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:19:56.475539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad, now model.jaffle_shop.orders)
[0m17:19:56.476189 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m17:19:56.476760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075)
[0m17:19:56.483596 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m17:19:56.484398 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.orders
[0m17:19:56.491060 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m17:19:56.491739 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m17:19:56.496142 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m17:19:56.497210 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:19:56.503667 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m17:19:56.504775 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m17:19:56.506702 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:19:56.507877 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.orders
[0m17:19:56.509543 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m17:19:56.510513 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m17:19:56.511217 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m17:19:56.512620 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.orders
[0m17:19:56.514017 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m17:19:56.514870 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now test.jaffle_shop.unique_stg_payments_payment_id.3744510712)
[0m17:19:56.516162 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m17:19:56.522335 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m17:19:56.523592 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m17:19:56.524877 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m17:19:56.526749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:56.527412 [debug] [MainThread]: Connection 'model.jaffle_shop.orders' was properly closed.
[0m17:19:56.528070 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075' was properly closed.
[0m17:19:56.528620 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m17:19:56.529186 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m17:19:56.533633 [debug] [MainThread]: Command end result
[0m17:19:56.762001 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/manifest.json
[0m17:19:56.765651 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/semantic_manifest.json
[0m17:19:56.778109 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rimix/work/kanai/traning/jaffle_shop/target/run_results.json
[0m17:19:56.783207 [debug] [MainThread]: Acquiring new fabric connection 'generate_catalog'
[0m17:19:56.783849 [info ] [MainThread]: Building catalog
[0m17:19:56.805480 [debug] [ThreadPool]: Acquiring new fabric connection 'jaffle_warehouse.information_schema'
[0m17:19:56.829514 [debug] [ThreadPool]: dbt-fabric
[0m17:19:56.831696 [debug] [ThreadPool]: Using fabric connection "jaffle_warehouse.information_schema"
[0m17:19:56.833023 [debug] [ThreadPool]: On jaffle_warehouse.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "connection_name": "jaffle_warehouse.information_schema"} */
USE [jaffle_warehouse];
            with
            principals as (
                select
                    name as principal_name,
                    principal_id as principal_id
                from
                    sys.database_principals 
            ),

            schemas as (
                select
                    name as schema_name,
                    schema_id as schema_id,
                    principal_id as principal_id
                from
                    sys.schemas 
            ),

            tables as (
                select
                    object_id,
                    name as table_name,
                    schema_id as schema_id,
                    principal_id as principal_id,
                    'BASE TABLE' as table_type
                from
                    sys.tables 
            ),

            tables_with_metadata as (
                select
                    object_id,
                    table_name,
                    schema_name,
                    coalesce(tables.principal_id, schemas.principal_id) as owner_principal_id,
                    table_type
                from
                    tables
                join schemas on tables.schema_id = schemas.schema_id
            ),

            views as (
                select
                    object_id,
                    name as table_name,
                    schema_id as schema_id,
                    principal_id as principal_id,
                    'VIEW' as table_type
                from
                    sys.views 
            ),

            views_with_metadata as (
                select
                    object_id,
                    table_name,
                    schema_name,
                    coalesce(views.principal_id, schemas.principal_id) as owner_principal_id,
                    table_type
                from
                    views
                join schemas on views.schema_id = schemas.schema_id
            ),

            tables_and_views as (
                select
                    object_id,
                    table_name,
                    schema_name,
                    principal_name,
                    table_type
                from
                    tables_with_metadata
                join principals on tables_with_metadata.owner_principal_id = principals.principal_id
                union all
                select
                    object_id,
                    table_name,
                    schema_name,
                    principal_name,
                    table_type
                from
                    views_with_metadata
                join principals on views_with_metadata.owner_principal_id = principals.principal_id
            ),

            cols as (

                select
                    c.object_id,
                    c.name as column_name,
                    c.column_id as column_index,
                    t.name as column_type
                from sys.columns as c 
                left join sys.types as t on c.system_type_id = t.system_type_id
            )

            select
                DB_NAME() as table_database,
                tv.schema_name as table_schema,
                tv.table_name,
                tv.table_type,
                null as table_comment,
                tv.principal_name as table_owner,
                cols.column_name,
                cols.column_index,
                cols.column_type,
                null as column_comment
            from tables_and_views tv
            join cols on tv.object_id = cols.object_id
            where (
                        (
                            upper(tv.schema_name) = upper('jaffle_training')
                            and upper(tv.table_name) = upper('raw_payments')
                        )
                     or 
                        (
                            upper(tv.schema_name) = upper('jaffle_training')
                            and upper(tv.table_name) = upper('raw_orders')
                        )
                     or 
                        (
                            upper(tv.schema_name) = upper('jaffle_training')
                            and upper(tv.table_name) = upper('orders')
                        )
                     or 
                        (
                            upper(tv.schema_name) = upper('jaffle_training')
                            and upper(tv.table_name) = upper('stg_customers')
                        )
                     or 
                        (
                            upper(tv.schema_name) = upper('jaffle_training')
                            and upper(tv.table_name) = upper('customers')
                        )
                     or 
                        (
                            upper(tv.schema_name) = upper('jaffle_training')
                            and upper(tv.table_name) = upper('raw_customers')
                        )
                     or 
                        (
                            upper(tv.schema_name) = upper('jaffle_training')
                            and upper(tv.table_name) = upper('stg_payments')
                        )
                     or 
                        (
                            upper(tv.schema_name) = upper('jaffle_training')
                            and upper(tv.table_name) = upper('stg_orders')
                        )
                    )

            order by column_index
            
    OPTION (LABEL = 'dbt-fabric-dw');

[0m17:19:56.834196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:56.834979 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=t5txzdn46dvuniywcpm5owcawm-bxibaf7eydnu5edyx5dy3yentq.datawarehouse.fabric.microsoft.com;Database=jaffle_warehouse;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;Authentication=ActiveDirectoryServicePrincipal;UID={af76a2f5-37e5-45fa-b5f6-46a692ae28a6};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.9.8;ConnectRetryCount=3;ConnectRetryInterval=10
[0m17:19:56.835769 [debug] [ThreadPool]: fabric adapter: Connected to db: jaffle_warehouse
[0m17:19:57.085237 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:57.132571 [debug] [ThreadPool]: On jaffle_warehouse.information_schema: ROLLBACK
[0m17:19:57.133702 [debug] [ThreadPool]: On jaffle_warehouse.information_schema: Close
[0m17:19:57.178089 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/rimix/work/kanai/traning/jaffle_shop/target/catalog.json
[0m17:19:57.276164 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/manifest.json
[0m17:19:57.284038 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rimix/work/kanai/traning/jaffle_shop/target/semantic_manifest.json
[0m17:19:57.285169 [info ] [MainThread]: Catalog written to /Users/rimix/work/kanai/traning/jaffle_shop/target/catalog.json
[0m17:19:57.314310 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.2274709, "process_in_blocks": "0", "process_kernel_time": 0.536351, "process_mem_max_rss": "130138112", "process_out_blocks": "0", "process_user_time": 4.001215}
[0m17:19:57.316457 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:19:57.316165 after 3.23 seconds
[0m17:19:57.317414 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:19:57.318229 [debug] [MainThread]: Connection 'jaffle_warehouse.information_schema' was properly closed.
[0m17:19:57.319241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b796780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c749880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c70b6e0>]}
[0m17:19:57.327000 [debug] [MainThread]: Flushing usage events
[0m17:19:58.466108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:20:07.725505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111250c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eaa450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eaa150>]}


============================== 17:20:07.733744 | 00bb7f57-8c96-4b65-b3ae-49c6909f8717 ==============================
[0m17:20:07.733744 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:20:07.734877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error': 'None', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'write_json': 'True', 'empty': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'static_parser': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'version_check': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/rimix/work/kanai/traning/jaffle_shop', 'invocation_command': 'dbt docs serve', 'log_path': '/Users/rimix/work/kanai/traning/jaffle_shop/logs', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:20:08.204508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00bb7f57-8c96-4b65-b3ae-49c6909f8717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f18680>]}
[0m17:20:08.305872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00bb7f57-8c96-4b65-b3ae-49c6909f8717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121fd6a0>]}
[0m17:47:11.080778 [error] [MainThread]: Encountered an error:

[0m17:47:11.111712 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:47:11.126573 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1623.4705, "process_in_blocks": "0", "process_kernel_time": 0.462674, "process_mem_max_rss": "115732480", "process_out_blocks": "0", "process_user_time": 2.860565}
[0m17:47:11.133472 [debug] [MainThread]: Command `dbt docs serve` failed at 17:47:11.132940 after 1623.48 seconds
[0m17:47:11.137120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eaa2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120c3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127170e0>]}
[0m17:47:11.139211 [debug] [MainThread]: Flushing usage events
[0m17:47:12.205399 [debug] [MainThread]: An error was encountered while trying to flush usage events
